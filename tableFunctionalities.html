<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Hello, world!</title>
  </head>

  <body>
    <div>
        <h1>Halloween Guest List (<span>3</span>)</h1>
        <table id="infoTable" class="table">
            <thead>
                <tr>
                    <th class="col-4">Name</th>
                    <th class="col-4">Character</th>
                    <th class="col-4">Likes</th>
                </tr>
            </thead>
            
            <tbody id="bTable">
            
            </tbody>

            <tfoot id="infoFoot">
                <tr>
                    <td><input type="text" id="nameInput"></td>
                    <td><input type="text" id="characterInput"></td>
                    <td><button id="addButton">Add</button></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <script>
        var jsonData = [
            {
                Name:'Oyvind Vik',
                Character:'Super-man',
                Likes: 8

            },
            {
                Name:'Tom Davidson',
                Character:'Naruto',
                Likes: 4

            },
            {
                Name:'Shane Butt',
                Character:'Nobita',
                Likes: 3

            }
        ]
        
        jsonData.forEach(i => { //Adds everyone from the jsonData
            let userId = i.Name.replace(/\s+/g, '_');
            let userData = `<tr id="${userId}"> 
                                <td>${i.Name}</td>
                                <td>${i.Character}</td>
                                <td>
                                    <span>${i.Likes}</span>
                                    <button id="plus" onclick="pmLikes('plus', '${userId}')">üëç</button>
                                    <button id="minus" onclick="pmLikes('minus', '${userId}')">üëé</button>
                                    <button id="remove" onclick="deleteRow('${userId}', this)">‚ùå</button>
                                </td>
                            </tr>`;
            document.querySelector("tbody").innerHTML += userData;         
        });

        document.getElementById('addButton').addEventListener('click', () => { //Adds new people into the row
            const name = document.getElementById('nameInput').value;
            const character = document.getElementById('characterInput').value;
            
            if(name && character) {
                let userId = name.replace(/\s+/g, '_');
                let likes = 0;
                let newRow = `<tr id="${userId}"> 
                                    <td>${name}</td>
                                    <td>${character}</td>
                                    <td>
                                        <span>${likes}</span>
                                        <button id="plus" onclick="pmLikes('plus', '${userId}')">üëç</button>
                                        <button id="minus" onclick="pmLikes('minus', '${userId}')">üëé</button>
                                        <button id="remove" onclick="deleteRow('${userId}', this)">‚ùå</button>
                                    </td>
                                </tr>`;
                document.querySelector('#infoTable tbody').innerHTML += newRow;
                document.getElementById('nameInput').value = '';
                document.getElementById('characterInput').value = '';
            }
        });

        const deleteRow = (person, thisObject) => {
            thisObject.parentNode.parentNode.remove();
        }

        function pmLikes(elementId, parentId) {
            if(elementId == "plus") {
                document.querySelector(`#${parentId} span`).innerHTML = Number(document.querySelector(`#${parentId} span`).innerHTML) + 1
            }
            else if (elementId == "minus") {
                if(Number(document.querySelector(`#${parentId} span`).innerHTML) == 0)
                    return;
                    
                document.querySelector(`#${parentId} span`).innerHTML = Number(document.querySelector(`#${parentId} span`).innerHTML) - 1
            }
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </body>

  <style>
    /*    
    table, th, td {
        border: 1px solid lightgray
    }
    */
    thead {
        background-color: black;
        color: white;
    }
    #bTable tr:first-child { /*Change to be highest like count*/
        color: green;
        font-weight: bold;
    }

    #infoTable tr:nth-child(even) {
        background-color: lightgray;
    }
    #infoFoot tr:nth-child(odd) {
        background-color: lightgray;
    }
  </style>
</html>